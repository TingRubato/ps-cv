function renderJobMap(t){const e=960,o=600,r=d3.scaleOrdinal(d3.schemeCategory10),a=d3.geoAlbersUsa().scale(1280).translate([480,300]),s=(d3.geoPath(a),d3.select(t).append("svg").attr("width",e).attr("height",o)),n=s.append("text").attr("x",e/2).attr("y",40).attr("text-anchor","middle").attr("font-size",18).attr("font-weight","bold").text("Job Posting Map"),l=d3.select("body").append("div").style("position","absolute").style("background","white").style("border","1px solid black").style("padding","5px").style("border-radius","3px").style("pointer-events","none").style("opacity",0);Promise.all([fetch("/ps-cv/assets/json/10m.json").then(t=>t.json()),fetch("/ps-cv/assets/json/formatted.csv").then(t=>t.text()).then(t=>d3.csvParse(t,t=>({latitude:+t[0],longitude:+t[1],job_keyword:t.job_keyword.replace(/\+/g," "),time:d3.utcParse("%Y-%m-%d %H:%M")(`${t.Date} ${t.Time}`)})))]).then(([t,e])=>{function o(){m>=d.length&&(m=0),i(d[m].time),m++}function i(t){p.filter(e=>e.time<=t).transition().attr("r",3),p.filter(e=>e.time>t).transition().attr("r",0),n.text(`Job Postings as of ${d3.utcFormat("%Y-%m-%d %H:%M")(t)}`)}const d=e.filter(t=>t.time).sort((t,e)=>t.time-e.time);t.objects.lower48={type:"GeometryCollection",geometries:t.objects.states.geometries.filter(t=>"02"!==t.id&&"15"!==t.id)},s.append("path").datum(topojson.merge(t,t.objects.lower48.geometries)).attr("fill","#ddd").attr("d",d3.geoPath()),s.append("path").datum(topojson.mesh(t,t.objects.lower48,(t,e)=>t!==e)).attr("fill","none").attr("stroke","white").attr("stroke-linejoin","round").attr("d",d3.geoPath());const p=s.append("g").attr("fill","none").attr("stroke","black").selectAll("circle").data(d).join("circle").attr("transform",t=>{const e=a([t.longitude,t.latitude]);return e?`translate(${e[0]}, ${e[1]})`:null}).attr("fill",t=>r(t.job_keyword)).attr("r",0).on("mouseover",(t,e)=>{l.style("opacity",1).html(`<strong>Job Keyword:</strong> ${e.job_keyword}<br>\n               <strong>Time:</strong> ${d3.utcFormat("%Y-%m-%d %H:%M")(e.time)}`).style("left",`${t.pageX+10}px`).style("top",`${t.pageY-20}px`)}).on("mousemove",t=>{l.style("left",`${t.pageX+10}px`).style("top",`${t.pageY-20}px`)}).on("mouseout",()=>{l.style("opacity",0)}),c=s.append("g").attr("transform","translate(50, 425)");c.selectAll("g").data([...new Set(d.map(t=>t.job_keyword))]).join("g").attr("transform",(t,e)=>`translate(0, ${20*e})`).append("rect").attr("width",12).attr("height",12).attr("fill",t=>r(t)),c.selectAll("g").append("text").attr("x",18).attr("y",6).attr("dy","0.35em").attr("font-size",12).text(t=>t);let m=0;setInterval(o,50),i(d[0].time)})["catch"](t=>console.error("Error loading data or rendering the map:",t))}